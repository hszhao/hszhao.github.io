<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="main.css" rel="stylesheet" media="all">
    <meta name="description" content="Compositing-aware Image Search" />
    <meta name="keywords" content="Compositing-aware Image Search">
    <script>
    function buttonSwitch(id, text) {
        old_src = document.getElementById(id).src;
        ind = old_src.lastIndexOf('/');
        document.getElementById(id).src = old_src.substr(0, ind + 1) + text;
    }
    </script>
    <title>Compositing-aware Image Search</title>
</head>

<body>
    <div id="top_arrow" style="position: fixed; bottom: 10px; right: 10px;">
        <a href="#title">
<img src="./figures/top_arrow.jpg" style="border: 0pt none ; width: 26px; height: 32px;"/></a>
    </div>
    <h2 id="title" class="auto-style1">Compositing-aware Image Search</h2>
    <p class="auto-style7" align="center">
        <a href="https://hszhao.github.io" target="_blank">Hengshuang Zhao</a><sup>1</sup>&nbsp;&nbsp;&nbsp;
        <a href="http://users.eecs.northwestern.edu/~xsh835" target="_blank">Xiaohui Shen</a><sup>2</sup>&nbsp;&nbsp;&nbsp;
        <a href="https://sites.google.com/site/zhelin625" target="_blank">Zhe Lin</a><sup>3</sup>&nbsp;&nbsp;&nbsp;
        <a href="http://www.eecs.harvard.edu/~kalyans" target="_blank">Kalyan Sunkavalli</a><sup>3</sup>&nbsp;&nbsp;&nbsp;
        <a href="https://www.brianpricephd.com" target="_blank">Brian Price</a><sup>3</sup>&nbsp;&nbsp;&nbsp;
        <a href="http://www.cse.cuhk.edu.hk/leojia" target="_blank">Jiaya Jia</a><sup>1,4</sup>&nbsp;&nbsp;&nbsp;
    </p>
    <p class="auto-style7" align="center">
        <sup>1</sup> The Chinese Univeristy of Hong Kong&nbsp;&nbsp;&nbsp;&nbsp;
        <sup>2</sup> ByteDance AI Lab&nbsp;&nbsp;&nbsp;&nbsp;
        <sup>3</sup> Adobe Research&nbsp;&nbsp;&nbsp;&nbsp;
        <sup>4</sup> Tencent Youtu Lab&nbsp;&nbsp;&nbsp;&nbsp;
    </p>
    <p align="center">
        <table style="width:960px" align="center">
            <tr>
                <td><img width=960px alt="" src="figures/definition.png"></td>
            </tr>
            <tr>
                <td>
                    <p class="auto-style5" align="justify">Compositing-aware image search. Given a background image as a query, the task is to find foreground objects of a certain category that can be composited into the background at a specific location, as indicated by the rectangle.</p>
                </td>
            </tr>
        </table>
        <p class="auto-style4"><strong>Abstract</span></strong></p>
        <p class="auto-style5">We present a new image search technique that, given a background image, returns compatible foreground objects for image compositing tasks. The compatibility of a foreground object and a background scene depends on various aspects such as semantics, surrounding context, geometry, style and color. However, existing image search techniques measure the similarities on only a few aspects, and may return many results that are not suitable for compositing. Moreover, the importance of each factor may vary for different object categories and image content, making it difficult to manually define the matching criteria. In this paper, we propose to learn feature representations for foreground objects and background scenes respectively, where image content and object category information are jointly encoded during training. As a result, the learned features can adaptively encode the most important compatibility factors. We project the features to a common embedding space, so that the compatibility scores can be easily measured using the cosine similarity, enabling very efficient search. We collect an evaluation set consisting of eight object categories commonly used in compositing tasks, on which we demonstrate that our approach significantly outperforms other search techniques.</p>
        <p class="auto-style4"><strong>Download</span></strong></p>
        <table cellSpacing=4 cellPadding=2 border=0 style="width: 90%">
            <tr COLSPAN="2">
                <td align="center" valign="center">
                    <img style="padding:0; clear:both; " src="figures/paper.png" align="middle" alt="Snapshot for paper" class="pdf" width="200" />
                </td>
                <td align="left" class="auto-style5">"Compositing-aware Image Search&quot;
                    <br> Hengshuang Zhao, Xiaohui Shen, Zhe Lin, Kalyan Sunkavalli, Brian Price, Jiaya Jia.
                    <br>
                    <em>European Conference on Computer Vision</em> (<b>ECCV</b>), 2018.</br>
                    <br>
                    <img alt="" height="32" src="figures/pdf.png">&nbsp;&nbsp;[<a href="../../paper/eccv18_cais.pdf">Paper</a>]&nbsp;&nbsp;[<a href="../../paper/eccv18_cais_supp.pdf">Supp</a>]&nbsp;&nbsp;[<a href="../../paper/eccv18_cais_bib.txt">Bib</a>]
                </td>
            </tr>
        </table>
        <p class="auto-style4"><strong>Architecture</span></strong></p>
        <table style="width:960px" align="center">
            <tr>
                <td><img width=960px alt="" src="figures/cais.png"></td>
            </tr>
            <tr>
                <td>
                    <p class="auto-style5">Overall framework of the proposed compositing-aware image search (CAIS) system. A symmetric two-stream feature embedding network is utilized to extract background and foreground image features separately, in which a MCB module is introduced to incorporate category information. A feature transformation module is then performed to generate the final feature representations.</p>
                </td>
            </tr>
        </table>
        <p class="auto-style4"><strong>Performance</span></strong></p>
        <table style="width:960px" align="center">
            <tr>
                <td><img width=450px alt="" src="figures/result1.png"></td>
                <td><img width=450px alt="" src="figures/result2.png"></td>
            </tr>
        </table>
        <p class="auto-style4"><strong>Visualization</span></strong></p>
        <table style="width:960px" align="center">
            <tr>
                <td><img width=960px alt="" src="figures/visualcomparison.png"></td>
            </tr>
            <tr>
                <td>
                    <p class="auto-style5">Visual search results: in each example, the yellow box indicates the position of foreground object to be inserted. The 1st to the 4th rows show the retrieved results using RealismCNN, shape information, classification features and our approach, respectively. The text boxes with ‘green’ and ‘red’ color in the top left corner of the foregrounds represent ‘positive’ and ‘negative’ foregrounds respectively. Our returned results contain more compatible foregrounds for image compositing.</p>
                </td>
            </tr>
            <tr>
                <td><img width=960px alt="" src="figures/newclass.png"></td>
            </tr>
            <tr>
                <td>
                    <p class="auto-style5">Generalization to new categories: we test our method on new categories that have not been trained. Even without training on the new classes, the algorithm still works reasonably well. Interestingly, the retrieved clocks are all in rectangular shape, mostly because of the bias induced from the ‘painting’ category during training. Our method can easily scale up to much more categories if new training data are available, as the category information can be incorporated through the word feature branch, while the network architecture would still remain the same.</p>
                </td>
            </tr>
            <tr>
                <td><img width=960px alt="" src="figures/sensitive.png"></td>
            </tr>
            <tr>
                <td>
                    <p class="auto-style5">Our search results are tuned to location and aspect ratio of the bounding box.</p>
                </td>
            </tr>
        </table>
        <p align="center">[<a href="../../paper/eccv18_cais_supp.pdf">More Visualization</a>]</p>
        <p class="auto-style1">
            <font color="#999999">Last update: Aug. 18, 2018</font>
        </p>
</body>

</html>